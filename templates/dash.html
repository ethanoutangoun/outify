
<html>
    <head>
        <title>Outify</title>
        <link rel="stylesheet" href="/static/dash.css">
        <!-- Include the Satoshi font from Google Fonts -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Satoshi&display=swap">
        <style>
            body {
                font-family: 'Satoshi', sans-serif; /* Use Satoshi font for the body */
            }

            /* Add other CSS styles using the Satoshi font here */
        </style>
        
    </head>

    <body>
        <div class="grid">
            <div class="col">
            <div>
                <h1>Dashboard</h1>
                
                

            </div>
            <div>
                <h4>Logged in as {{ username }}</h4>
                <a href='/logout'>Logout</a>
            </div>
            
            <h2>Currently Playing</h2>



            
              


            <div class="playback" id = "playback-info">
                <script>
                    //Async function to update current song playing
                    
                    function updateCurrentSong() {
                      fetch('/get_current_song')
                        .then(response => response.json())
                        .then(data => {
                          const playbackDiv = document.getElementById('playback-info');
                          if (Object.keys(data).length > 0) {
                            // Update the HTML elements with the current song information
                            playbackDiv.querySelector('img').src = data.album.images[0].url;
                            playbackDiv.querySelector('h3').innerText = data.name;
                            playbackDiv.querySelector('p').innerText = data.artists[0].name;
                          } else {
                            // If no song is playing, show a default message
                            playbackDiv.querySelector('img').src = ''; // Set a default image or hide the image
                            playbackDiv.querySelector('h3').innerText = 'No song is currently playing.';
                            playbackDiv.querySelector('p').innerText = '';
                          }
                        })
                        .catch(error => console.error('Error fetching current song:', error));
                    }
                  
                    // Refresh the current song information every 3 seconds
                    setInterval(updateCurrentSong, 3000);
                    
                </script>
                
                <img src="{{ playbackStatus[2] }}" width="75px" height="75px">
                <div>
                    <h3>{{ playbackStatus[0] }}</h3>
                    <p>{{ playbackStatus[1] }}</p>

                </div>

            </div>



            <h2>My Playlists</h2>
            
            
            <div id="playlist" class="playlist" data-playlist = "{{ playlists }}">


                
                <script>
                    const playlists = JSON.parse(document.getElementById("playlist").getAttribute("data-playlist"));
                    
                    console.log(playlists);
                    function createSongElement(name, imageUrl) {
                        const songDiv = document.createElement('div');
                        songDiv.classList.add('song');

                        const img = document.createElement('img');
                        //img.classList.add('song');
                        img.src = imageUrl;
                        img.height = 50;
                        img.width = 50;

                        const h3 = document.createElement('h3');
                        //h3.classList.add('song');
                        h3.textContent = name;

                        songDiv.appendChild(img);
                        songDiv.appendChild(h3);

                        return songDiv;
                    }

                    // Function to render all the songs
                    function renderSongs() {
                        const playlistContainer = document.getElementById('playlist');

                        // Clear any existing content in the container
                        playlistContainer.innerHTML = '';

                        // Iterate through the playlists data and create elements
                        playlists.forEach(songData => {
                            const songElement = createSongElement(songData[0], songData[1]);
                            playlistContainer.appendChild(songElement);
                        });
                    }

                    // Call the renderSongs function to render the initial data
                    renderSongs();
                </script>


            
            </div>
        
            
            </div>
        
            <div class="col">
                <h1>Generate Playlist</h1>
            </div>



        




    </div>
    </body>
</html>

